<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Internships | UniLink</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/frontend/css/internship.css">
</head>
<body>
    <nav class="navbar">
        <a href="homepage.html">Home</a>
        <a href="Event.html">Events</a>
        <a href="Signin.html">Sign In</a>
        <a href="Signup.html">Sign Up</a>
        <a href="Admin.html">Admin Login</a>
    </nav>
    
    <h1 class="page-header">Internship Opportunities</h1>
    
    <div class="filter-container">
        <div>
            <label for="search">Search Internships</label>
            <input type="text" id="search" placeholder="Type internship name...">
        </div>
        <div>
            <label for="sort">Sort By</label>
            <select id="sort">
                <option value="date">Start Date</option>
                <option value="location">Location</option>
            </select>
        </div>
        <div>
            <label for="category">Filter Category</label>
            <select id="category">
                <option value="all">All Categories</option>
                <option value="technology">Technology</option>
                <option value="marketing">Marketing</option>
                <option value="finance">Finance</option>
            </select>
        </div>
    </div>
    
    <div class="internships-list">
        <div class="internship-item">
            <h2 class="internship-title">Software Developer Intern</h2>
            <p class="internship-details"><i class="fas fa-building"></i> Company: TechCorp</p>
            <p class="internship-details"><i class="fas fa-calendar-alt"></i> Start Date: May 1, 2025</p>
            <p class="internship-details"><i class="fas fa-map-marker-alt"></i> Location: New York</p>
            <p class="internship-details"><i class="fas fa-tag"></i> Category: Technology</p>
            <a href="apply.html" class="internship-button">Apply Now</a>
        </div>
        <div class="internship-item">
            <h2 class="internship-title">Digital Marketing Intern</h2>
            <p class="internship-details"><i class="fas fa-building"></i> Company: MarketMasters</p>
            <p class="internship-details"><i class="fas fa-calendar-alt"></i> Start Date: May 10, 2025</p>
            <p class="internship-details"><i class="fas fa-map-marker-alt"></i> Location: Los Angeles</p>
            <p class="internship-details"><i class="fas fa-tag"></i> Category: Marketing</p>
            <a href="apply.html" class="internship-button">Apply Now</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('/api/internships');
                const internships = await response.json();
                
                const internshipsList = document.querySelector('.internships-list');
                internshipsList.innerHTML = '';
                
                internships.forEach(internship => {
                    const startDate = new Date(internship.start_date);
                    const formattedDate = startDate.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    const internshipItem = document.createElement('div');
                    internshipItem.className = 'internship-item';
                    internshipItem.innerHTML = `
                        <h2 class="internship-title">${internship.title}</h2>
                        <p class="internship-details"><i class="fas fa-building"></i> Company: ${internship.company}</p>
                        <p class="internship-details"><i class="fas fa-calendar-alt"></i> Start Date: ${formattedDate}</p>
                        <p class="internship-details"><i class="fas fa-map-marker-alt"></i> Location: ${internship.location}</p>
                        <p class="internship-details"><i class="fas fa-tag"></i> Category: ${internship.category}</p>
                        <a href="apply.html?id=${internship.id}" class="internship-button">Apply Now</a>
                    `;
                    internshipsList.appendChild(internshipItem);
                });
                
                // Filter/Sort functionality
                document.querySelectorAll('select, input').forEach(element => {
                    element.addEventListener('change', updateFilters);
                });
                
                async function updateFilters() {
                    const search = document.getElementById('search').value.toLowerCase();
                    const sortBy = document.getElementById('sort').value;
                    const category = document.getElementById('category').value;
                    
                    const res = await fetch('/api/internships');
                    let filteredInternships = await res.json();
                    
                    filteredInternships = filteredInternships.filter(internship => {
                        return (internship.title.toLowerCase().includes(search) &&
                               (category === 'all' || internship.category === category));
                    });
                    
                    filteredInternships.sort((a, b) => {
                        if (sortBy === 'date') return new Date(a.start_date) - new Date(b.start_date);
                        if (sortBy === 'location') return a.location.localeCompare(b.location);
                        return 0;
                    });
                    
                    const internshipsList = document.querySelector('.internships-list');
                    internshipsList.innerHTML = '';
                    
                    filteredInternships.forEach(internship => {
                        const startDate = new Date(internship.start_date);
                        const formattedDate = startDate.toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                        
                        const internshipItem = document.createElement('div');
                        internshipItem.className = 'internship-item';
                        internshipItem.innerHTML = `
                            <h2 class="internship-title">${internship.title}</h2>
                            <p class="internship-details"><i class="fas fa-building"></i> Company: ${internship.company}</p>
                            <p class="internship-details"><i class="fas fa-calendar-alt"></i> Start Date: ${formattedDate}</p>
                            <p class="internship-details"><i class="fas fa-map-marker-alt"></i> Location: ${internship.location}</p>
                            <p class="internship-details"><i class="fas fa-tag"></i> Category: ${internship.category}</p>
                            <a href="apply.html?id=${internship.id}" class="internship-button">Apply Now</a>
                        `;
                        internshipsList.appendChild(internshipItem);
                    });
                }
            } catch (error) {
                console.error('Error loading internships:', error);
            }
        });
    </script>
</body>
</html>
