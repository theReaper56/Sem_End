<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events | UniLink</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/frontend/css/event.css">
</head>
<body>
    <nav class="navbar">
        <a href="homepage.html">Home</a>
        <a href="internship.html">Internships</a>
        <a href="Signin.html">Sign In</a>
        <a href="Signup.html">Sign Up</a>
        <a href="Admin.html">Admin Login</a>
    </nav>
    
    <h1 class="page-header">Events</h1>
    
    <div class="filter-container">
        <div>
            <label for="search">Search Events</label>
            <input type="text" id="search" placeholder="Type event name...">
        </div>
        <div>
            <label for="sort">Sort By</label>
            <select id="sort">
                <option value="date">Date</option>
                <option value="location">Location</option>
            </select>
        </div>
        <div>
            <label for="category">Filter Category</label>
            <select id="category">
                <option value="all">All Categories</option>
                <option value="workshop">Workshop</option>
                <option value="competition">Competition</option>
                <option value="seminar">Seminar</option>
            </select>
        </div>
    </div>
    
    <div class="events-list">
        <div class="event-item">
            <h2 class="event-title">Workshop on AI</h2>
            <p class="event-details"><i class="fas fa-calendar-alt"></i> Date: April 15, 2025</p>
            <p class="event-details"><i class="fas fa-map-marker-alt"></i> Location: New York</p>
            <p class="event-details"><i class="fas fa-tag"></i> Category: Workshop</p>
        </div>
        <div class="event-item">
            <h2 class="event-title">Coding Competition</h2>
            <p class="event-details"><i class="fas fa-calendar-alt"></i> Date: April 20, 2025</p>
            <p class="event-details"><i class="fas fa-map-marker-alt"></i> Location: San Francisco</p>
            <p class="event-details"><i class="fas fa-tag"></i> Category: Competition</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('/api/events');
                const events = await response.json();
                
                const eventsList = document.querySelector('.events-list');
                eventsList.innerHTML = '';
                
                events.forEach(event => {
                    const eventDate = new Date(event.date);
                    const formattedDate = eventDate.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    const eventItem = document.createElement('div');
                    eventItem.className = 'event-item';
                    eventItem.innerHTML = `
                        <h2 class="event-title">${event.title}</h2>
                        <p class="event-details"><i class="fas fa-calendar-alt"></i> Date: ${formattedDate}</p>
                        <p class="event-details"><i class="fas fa-map-marker-alt"></i> Location: ${event.location}</p>
                        <p class="event-details"><i class="fas fa-tag"></i> Category: ${event.category}</p>
                    `;
                    eventsList.appendChild(eventItem);
                });
                
                // Filter/Sort functionality
                document.querySelectorAll('select, input').forEach(element => {
                    element.addEventListener('change', updateFilters);
                });
                
                async function updateFilters() {
                    const search = document.getElementById('search').value.toLowerCase();
                    const sortBy = document.getElementById('sort').value;
                    const category = document.getElementById('category').value;
                    
                    const res = await fetch('/api/events');
                    let filteredEvents = await res.json();
                    
                    filteredEvents = filteredEvents.filter(event => {
                        return (event.title.toLowerCase().includes(search) &&
                               (category === 'all' || event.category === category));
                    });
                    
                    filteredEvents.sort((a, b) => {
                        if (sortBy === 'date') return new Date(a.date) - new Date(b.date);
                        if (sortBy === 'location') return a.location.localeCompare(b.location);
                        return 0;
                    });
                    
                    const eventsList = document.querySelector('.events-list');
                    eventsList.innerHTML = '';
                    
                    filteredEvents.forEach(event => {
                        const eventDate = new Date(event.date);
                        const formattedDate = eventDate.toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                        
                        const eventItem = document.createElement('div');
                        eventItem.className = 'event-item';
                        eventItem.innerHTML = `
                            <h2 class="event-title">${event.title}</h2>
                            <p class="event-details"><i class="fas fa-calendar-alt"></i> Date: ${formattedDate}</p>
                            <p class="event-details"><i class="fas fa-map-marker-alt"></i> Location: ${event.location}</p>
                            <p class="event-details"><i class="fas fa-tag"></i> Category: ${event.category}</p>
                        `;
                        eventsList.appendChild(eventItem);
                    });
                }
            } catch (error) {
                console.error('Error loading events:', error);
            }
        });
    </script>
</body>
</html>